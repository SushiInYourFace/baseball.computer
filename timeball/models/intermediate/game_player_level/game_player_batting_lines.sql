SELECT
    ids.game_id,
    ids.batting_team_id,
    ids.batter_id,
    SUM(stats.plate_appearances) AS plate_appearances,
    SUM(stats.at_bats) AS at_bats,
    SUM(stats.hits) AS hits,
    SUM(stats.singles) AS singles,
    SUM(stats.doubles) AS doubles,
    SUM(stats.triples) AS triples,
    SUM(stats.home_runs) AS home_runs,
    SUM(stats.runs_batted_in) AS runs_batted_in,
    SUM(stats.strikeouts) AS strikeouts,
    SUM(stats.walks) AS walks,
    SUM(stats.intentional_walks) AS intentional_walks,
    SUM(stats.hit_by_pitches) AS hit_by_pitches,
    SUM(stats.sacrifice_hits) AS sacrifice_hits,
    SUM(stats.sacrifice_flies) AS sacrifice_flies,
    SUM(stats.reached_on_errors) AS reached_on_errors,
    SUM(stats.reached_on_interferences) AS reached_on_interferences,
    SUM(stats.on_base_opportunities) AS on_base_opportunities,
    SUM(stats.on_base_successes) AS on_base_successes,
    SUM(stats.grounded_into_double_plays) AS grounded_into_double_plays,
    SUM(stats.double_plays) AS double_plays,
    SUM(stats.triple_plays) AS triple_plays,
    SUM(stats.batting_outs) AS batting_outs,
FROM {{ ref('event_batting_stats') }} AS stats
LEFT JOIN {{ ref('event_states_batter_pitcher') }} AS ids USING (event_key)
GROUP BY 1, 2, 3
